<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Demo for Rule Based Natural Language Processing &mdash; DACKAR 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=2709fde1"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            DACKAR
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install_spacy3.5.html">Installation with Spacy 3.5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation with Spacy 3.1 (Archived)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DACKAR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Demo for Rule Based Natural Language Processing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/RuleBasedNLP.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Demo-for-Rule-Based-Natural-Language-Processing">
<h1>Demo for Rule Based Natural Language Processing<a class="headerlink" href="#Demo-for-Rule-Based-Natural-Language-Processing" title="Link to this heading">¶</a></h1>
<section id="1.-Set-up-the-path,-so-that-the-NLP-modules-can-be-found">
<h2>1. Set up the path, so that the NLP modules can be found<a class="headerlink" href="#1.-Set-up-the-path,-so-that-the-NLP-modules-can-be-found" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import os
import sys

cwd = os.getcwd()
frameworkDir = os.path.abspath(os.path.join(cwd, os.pardir, &#39;src&#39;))
sys.path.append(frameworkDir)
</pre></div>
</div>
</div>
</section>
<section id="2.-Load-Spacy-module">
<h2>2. Load Spacy module<a class="headerlink" href="#2.-Load-Spacy-module" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import spacy
nlp = spacy.load(&quot;en_core_web_lg&quot;, exclude=[])
</pre></div>
</div>
</div>
</section>
<section id="3.-Load-other-modules">
<h2>3. Load other modules<a class="headerlink" href="#3.-Load-other-modules" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import pandas as pd
</pre></div>
</div>
</div>
</section>
<section id="4.-Import-NLP-modules">
<h2>4. Import NLP modules<a class="headerlink" href="#4.-Import-NLP-modules" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from dackar.workflows.RuleBasedMatcher import RuleBasedMatcher
from dackar import config
from dackar.utils.nlp.nlp_utils import generatePatternList
from dackar.utils.opm.OPLparser import OPMobject
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/wangc/miniconda3/envs/dackar_libs/lib/python3.11/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm
Warming up PyWSD (takes ~10 secs)... took 4.646389961242676 secs.
</pre></div></div>
</div>
</section>
<section id="5.-Set-up-logging">
<h2>5. Set up logging<a class="headerlink" href="#5.-Set-up-logging" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import logging
logging.basicConfig(format=&#39;%(asctime)s %(name)-20s %(levelname)-8s %(message)s&#39;, datefmt=&#39;%d-%b-%y %H:%M:%S&#39;, level=logging.DEBUG)
</pre></div>
</div>
</div>
</section>
<section id="6.-Read-and-process-entities">
<h2>6. Read and process entities<a class="headerlink" href="#6.-Read-and-process-entities" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ents = []
entityFile = config.nlpConfig[&#39;files&#39;][&#39;entity_file&#39;]
entityList = pd.read_csv(entityFile).values.ravel().tolist()
ents.extend(entityList)
ents = set(ents)
label = &quot;pump_component&quot;
entId = &quot;SSC&quot;
patternsOPM = generatePatternList(ents, label=label, id=entId, nlp=nlp, attr=&quot;LEMMA&quot;)
</pre></div>
</div>
</div>
</section>
<section id="7.-Read-and-process-causal-keywords">
<h2>7. Read and process causal keywords<a class="headerlink" href="#7.-Read-and-process-causal-keywords" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>causalLabel = &quot;causal_keywords&quot;
causalID = &quot;causal&quot;
patternsCausal = []
causalFilename = config.nlpConfig[&#39;files&#39;][&#39;cause_effect_keywords_file&#39;]
ds = pd.read_csv(causalFilename, skipinitialspace=True)
for col in ds.columns:
    vars = set(ds[col].dropna())
    patternsCausal.extend(generatePatternList(vars, label=causalLabel, id=causalID, nlp=nlp, attr=&quot;LEMMA&quot;))
</pre></div>
</div>
</div>
</section>
<section id="8.-Create-Rule-based-matcher-with-entity-list-and-causal-entity-list">
<h2>8. Create Rule-based matcher with entity list and causal entity list<a class="headerlink" href="#8.-Create-Rule-based-matcher-with-entity-list-and-causal-entity-list" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>name = &#39;ssc_entity_ruler&#39;
matcher = RuleBasedMatcher(nlp, entID=entId, causalKeywordID=causalID)
matcher.addEntityPattern(name, patternsOPM)

causalName = &#39;causal_keywords_entity_ruler&#39;
matcher.addEntityPattern(causalName, patternsCausal)
</pre></div>
</div>
</div>
</section>
<section id="9.-Read-input-text-file,-or-users-can-provide-a-raw-string">
<h2>9. Read input text file, or users can provide a raw string<a class="headerlink" href="#9.-Read-input-text-file,-or-users-can-provide-a-raw-string" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>textFile = config.nlpConfig[&#39;files&#39;][&#39;text_file&#39;]
with open(textFile, &#39;r&#39;) as ft:
    doc = ft.read()
</pre></div>
</div>
</div>
</section>
<section id="10.-Process-raw-string-data-using-matcher">
<h2>10. Process raw string data using matcher<a class="headerlink" href="#10.-Process-raw-string-data-using-matcher" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>matcher(doc)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(Investigation, revealed, valves) (This event, prevented, structures) (Investigation, revealed, valves) (ASDVs, prevent, valves) (room, controlled, system) (fuse, resulted, power) (failure, The cause, failure) (that, the start, the event) (that, contributed, the event) (failure, The cause, failure) (This, resulted, power) (This action, prevent, this failure)
</pre></div></div>
</div>
</section>
<section id="11.-Access-processed-information-from-matcher">
<h2>11. Access processed information from matcher<a class="headerlink" href="#11.-Access-processed-information-from-matcher" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>matcher._extractedCausals
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[Investigation,
  None,
  revealed,
  steam dump control relay,
  None,
  Investigation revealed that the steam dump control relay had failed, rendering all four atmospheric steam dump valves inoperable.,
  False],
 [Investigation,
  None,
  rendering,
  atmospheric steam dump valves,
  None,
  Investigation revealed that the steam dump control relay had failed, rendering all four atmospheric steam dump valves inoperable.,
  False],
 [steam dump control relay,
  None,
  rendering,
  atmospheric steam dump valves,
  None,
  Investigation revealed that the steam dump control relay had failed, rendering all four atmospheric steam dump valves inoperable.,
  False],
 [Investigation,
  None,
  revealed,
  steam dump control relay,
  None,
  Investigation revealed that the steam dump control relay had failed, rendering all four atmospheric steam dump valves inoperable, and causing an entry into a 24-hour shutdown action statement limiting condition for operation 3.7.4.,
  False],
 [Investigation,
  None,
  rendering,
  atmospheric steam dump valves,
  None,
  Investigation revealed that the steam dump control relay had failed, rendering all four atmospheric steam dump valves inoperable, and causing an entry into a 24-hour shutdown action statement limiting condition for operation 3.7.4.,
  False],
 [steam dump control relay,
  None,
  rendering,
  atmospheric steam dump valves,
  None,
  Investigation revealed that the steam dump control relay had failed, rendering all four atmospheric steam dump valves inoperable, and causing an entry into a 24-hour shutdown action statement limiting condition for operation 3.7.4.,
  False],
 [ASDVs,
  None,
  prevent,
  steam safety valves,
  None,
  The capacity of the ASDVs is adequate to prevent lifting of the main steam safety valves following a turbine and reactor trip.,
  False],
 [ASDVs,
  None,
  prevent,
  turbine,
  None,
  The capacity of the ASDVs is adequate to prevent lifting of the main steam safety valves following a turbine and reactor trip.,
  False],
 [control room,
  None,
  controlled,
  ASDVs,
  None,
  Although the steam dump system is arranged for automatic operation, the ASDVs may be manually controlled from either control room or engineered safeguards control panels.,
  True],
 [control room,
  None,
  controlled,
  steam dump system,
  None,
  Although the steam dump system is arranged for automatic operation, the ASDVs may be manually controlled from either control room or engineered safeguards control panels.,
  True],
 [control panels,
  None,
  controlled,
  ASDVs,
  None,
  Although the steam dump system is arranged for automatic operation, the ASDVs may be manually controlled from either control room or engineered safeguards control panels.,
  True],
 [control panels,
  None,
  controlled,
  steam dump system,
  None,
  Although the steam dump system is arranged for automatic operation, the ASDVs may be manually controlled from either control room or engineered safeguards control panels.,
  True],
 [steam dump control relay coil,
  None,
  due to,
  failure,
  None,
  Troubleshooting the circuit identified that the Bussmann fuse FUZ/IM13-1, model number FNM-5, was found opened due to the steam dump control relay coil failure.,
  False],
 [fuse,
  None,
  resulted in,
  IM13 scheme,
  None,
  The opening of the fuse resulted in loss of power to the IM13 scheme, which disabled the automatic fast-open function, as well as the manual operation, of the ASDVs.,
  False],
 [relay coil,
  None,
  The cause,
  SDCR coil,
  None,
  The cause of the SDCR coil failure is overheating due to the age of the relay coil being beyond the vendor recommended life for a normally energized relay.,
  False],
 [relay,
  None,
  The cause,
  SDCR coil,
  None,
  The cause of the SDCR coil failure is overheating due to the age of the relay coil being beyond the vendor recommended life for a normally energized relay.,
  False],
 [relay,
  None,
  due to,
  relay,
  None,
  The duty cycle of the relay was set at &#34;low duty cycle&#34; when it should have been &#34;high duty cycle&#34; due to the normally energized state of the relay.,
  False],
 [electrical coil,
  None,
  due to,
  SDCR relay,
  None,
  The fuse opened because the SDCR relay failed due to an internal failure of the electrical coil.,
  False],
 [relay coil,
  None,
  The cause,
  relay coil,
  None,
  The cause of the relay coil failure is overheating due to the age of the relay coil being beyond the vendor recommended life.,
  False],
 [relay,
  None,
  due to,
  relay,
  None,
  The relay coil was beyond the vendor recommended life because the duty cycle of the relay was set at &#34;low duty cycle&#34; when it should have been &#34;high duty cycle&#34; due to the normally energized state of the relay.
  ,
  False],
 [SDCR,
  None,
  The actual consequence,
  IM13 circuit,
  None,
  The actual consequence of the failure of the SDCR, which was a short-circuit in the relay coil, was overcurrent in the IM13 circuit and opening of fuse FUZ/IM13-1.,
  False],
 [SDCR,
  None,
  The actual consequence,
  fuse FUZ/IM13-1,
  None,
  The actual consequence of the failure of the SDCR, which was a short-circuit in the relay coil, was overcurrent in the IM13 circuit and opening of fuse FUZ/IM13-1.,
  False],
 [relay coil,
  None,
  The actual consequence,
  IM13 circuit,
  None,
  The actual consequence of the failure of the SDCR, which was a short-circuit in the relay coil, was overcurrent in the IM13 circuit and opening of fuse FUZ/IM13-1.,
  False],
 [relay coil,
  None,
  The actual consequence,
  fuse FUZ/IM13-1,
  None,
  The actual consequence of the failure of the SDCR, which was a short-circuit in the relay coil, was overcurrent in the IM13 circuit and opening of fuse FUZ/IM13-1.,
  False],
 [This,
  None,
  resulted in,
  IM13 scheme,
  None,
  This resulted in loss of power to the IM13 scheme, which disables the automatic fast-open function of the ASDVs and disables manual operation of the ASDVs.,
  False],
 [This,
  None,
  resulted in,
  ASDVs,
  None,
  This resulted in loss of power to the IM13 scheme, which disables the automatic fast-open function of the ASDVs and disables manual operation of the ASDVs.,
  False],
 [This,
  None,
  resulted in,
  ASDVs,
  None,
  This resulted in loss of power to the IM13 scheme, which disables the automatic fast-open function of the ASDVs and disables manual operation of the ASDVs.,
  False],
 [Relay,
  None,
  Due to,
  Failure,
  None,
  Atmospheric Steam Dump Valves Inoperable Due to Relay Failure.,
  False]]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright 2024, Battelle Energy Alliance, LLC  ALL RIGHTS RESERVED.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>